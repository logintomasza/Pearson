---
title: "Pearson Audition Project"
author: "Tomasz Dąbrowski"
date: "20th of October, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```

## Introduction
This document presents exploratoy research of Pearson's e-learning platform data. It will contain research hypothesis, descriptive statisitics, hypothesis testing, and others.

### Loading data
Let's load a data from working directory and then take a look how it looks like. 
```{r data}
dt <- dt <- read.csv("data.csv", header = T, sep = ",")
head(dt)

```
Let's see how many variables and observations are in the spreadsheet.
```{r dims}
dim(dt)
```
What are the types of the variables?
```{r types}
str(dt)
```

### Understanding vriables 
All right, we have some information about data. It's time to make some assumptions. Which varaibles look interesting? They are described in the attached document. Let's have them here...

* __learner__ id : anonymized student identifier
* __country__ : country code of the student
* __in_course__ : “t” if the student belongs to course taught by a teacher (as opposed
to studying alone)
* __unit__ : number or name of a unit (chapter) in the workbook
* __avg_score__ : average percentage score on all activities within a given unit
* __completion__ : the percentage of activities completed in a given unit, out of all
activities available in that unit
* __inv_rate__ : This is the extent to which a student deviates from the suggested
order of activities by the pedagogy experts within a given unit. A value of zero
indicates no departure from the suggested order, a value of one indicates a
complete reversal of the order.

The __country__ variable looks promising. We will be able to compare performance of students across different countries. Thanks to __in_course__ variable, we will assesss efficiency of teachers. __unit__, __avg_score__ and __completion__ variables should tell us something about difficulty of certain units. __inv_rate__ seems to be very interesting. Do 'rebel' students perform better than 'regular' students? Are some countries more rebelious than others? Does teacher presence impact the way students learn?

### Exploring data
1. 
Let's load some useful packages now.

```{r libraries}

library(plyr)
library(ggplot2)
```



Questions:  
1. Which units are the hardest? Which have the smallest completion rate?  
2. Which country performs the best?  
3. Which country does have most rebelious students?  
4. What affects the most being succesfull? Country? Inverse index? having a teacher?  


#### Question 1: Which units are the hardest? Which have the smallest completion rate? 
```{r question1}

levels(dt$unit)
levels(dt$unit) <- c("1", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "REVIEW 1", "REVIEW 2", "REVIEW 3", "REVIEW 4", "VIDEO PODCASTS") 

qplot(x = avg_score, data = dt) +
  facet_wrap(~unit, ncol = 4)

qplot(x = avg_score, data = dt, geom = "freqpoly", color = unit)
  
```
  
What we can see, is that average score drops steadily with the progress of the student - with the exception of UNITS 2, 3 and 4. There must be something peculiar with them, preventing users from acheiving good scores. 

```{r completion}
qplot(x = completion, data = dt) +
  facet_wrap(~unit, ncol = 4)
```

From these plots we can see that majority of students has very low rate of completing the task in these units.

#### Question 2: Which country performs the best?  
We have 87 countries. How to compare the scores among them?
We need to average the average scores of students in these countries. We will choose only countries that have more than 500 observations. 
```{r question 2}
#install.packages("tidyr")
library(tidyr)
library(dplyr)

dt2 <- data.frame(dt$country, dt$avg_score)
colnames(dt2) <- c("country", "avg_score")

dt2 <- subset(dt2, dt$country != "") #subet of obs. with known countries
dt3 <- dt2 %>%
        group_by(country) %>%
        mutate(id = row_number()) %>%
        spread(country, avg_score) %>%
        select(-id)

stud_num <- apply(dt3, 2, function(x) length(which(!is.na(x)))) #Variable: How many non-NA's is there in a column?

means <- apply(dt3, 2, function(x) mean(x, na.rm = T)) #Variable: Means of average scores for every country
sd <- apply(dt3, 2, function(x) sd(x, na.rm = T))#Variable: Standard Deviation from the mean

dt5 <- data.frame(means, stud_num, sd)#Data frame with new variables

dt6 <- dt5[dt5$stud_num > 500, ] #Data frame with countries that have more than 500 observations
dt6$country <- rownames(dt6) #add Country as variable
rownames(dt6) <- 1:9 #Remove country names from rownames()

ggplot(data = dt6) +
  geom_point(mapping = aes(x = country, y = means)) #mean avg. scores for every country

```
We can observe that countries with the best mean scores are Italy (m = 0.83), Spain (m = 0.82) and Turkey (m = 0.80). Oman (m = 0.66) was the worst from the measured countries. 

#### 3. Does having a teacher improve performance? 
```{r teacher_vs_performance}
summary(dt$in_course)

reg <- lm(avg_score~in_course, data = dt)
summary(reg)

plot(dt$in_course, dt$avg_score)

```
  
As we can see from the plots above, tutored group has significantly higher scores than group without teacher (p < .001). 

#### 4. Does higher inversion rate improve performance?
```{r inv_vs_perf}
summary(dt$inv_rate)
reg2 <- lm(avg_score~inv_rate, data = dt)
summary(reg2)

plot(dt$inv_rate, dt$avg_score, xlab = "Inversion Rate", ylab = "Average Score")
abline(reg2, col="red")

```
  
As we can see from the regression line above, inverting designed learning order does not help better performance. Students should be encouraged to stay in track.  
